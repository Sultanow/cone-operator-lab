(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     17013,        497]
NotebookOptionsPosition[     16121,        476]
NotebookOutlinePosition[     16535,        492]
CellTagsIndexPosition[     16492,        489]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"1.", " ", "Daten", " ", "laden"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
  "path", "=", \
"\"\<C:/Users/sulta/git/cone-operator-lab/data/eigenvalues/box_a1.0_b1.5_c2.3_\
N20000.txt\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"allEigs", "=", 
   RowBox[{"Sort", "@", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"Import", "[", 
         RowBox[{"path", ",", "\"\<Table\>\""}], "]"}]}], "//", "N"}], ",", 
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nUse", "=", "20000"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"eigs", "=", 
   RowBox[{"allEigs", "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "nUse"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]N", "=", 
    RowBox[{"Last", "[", "eigs", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"2.", " ", "Theorie", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Exakte", " ", "Weyl"}], "-", "Referenz"}], ")"}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "1.5", ",", "2.3"}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Vtrue", "=", 
   RowBox[{"a", " ", "b", " ", "c"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Strue", "=", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "b"}], "+", 
      RowBox[{"a", " ", "c"}], "+", 
      RowBox[{"b", " ", "c"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A0true", "=", 
   RowBox[{"Vtrue", "/", 
    RowBox[{"(", 
     RowBox[{"6", " ", 
      RowBox[{"Pi", "^", "2"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"A1true", "=", 
   RowBox[{
    RowBox[{"-", "Strue"}], "/", 
    RowBox[{"(", 
     RowBox[{"16", " ", "Pi"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"alpha2Weyl", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", "b", "+", "c"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"8", " ", 
       RowBox[{"Sqrt", "[", "Pi", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"convert", " ", "alpha2"}], "->", 
    RowBox[{
     RowBox[{
     "A2", " ", "in", " ", "the", " ", "same", " ", "normalization", " ", 
      "used", " ", "in", " ", "the", " ", "heat"}], "-", "fit"}]}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"A2Weyl", "=", 
    RowBox[{"alpha2Weyl", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"4", " ", "Pi"}], ")"}], "^", 
       RowBox[{"(", 
        RowBox[{"3", "/", "2"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{"4", " ", 
        RowBox[{"Pi", "^", "3"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"3.", " ", "Scan"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"factors", "=", 
   RowBox[{"Range", "[", 
    RowBox[{"10", ",", "200", ",", "2"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"scanResults", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "tMin", ",", "tMax", ",", "tGrid", ",", "Z", ",", "X", ",", "coef"}],
          "}"}], ",", 
        RowBox[{
         RowBox[{"tMin", "=", 
          RowBox[{"f", "/", "\[Lambda]N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tMax", "=", 
          RowBox[{"500", "/", "\[Lambda]N"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"tGrid", "=", 
          RowBox[{"Exp", "@", 
           RowBox[{"Subdivide", "[", 
            RowBox[{
             RowBox[{"Log", "[", "tMin", "]"}], ",", 
             RowBox[{"Log", "[", "tMax", "]"}], ",", "200"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Z", "=", 
          RowBox[{"Total", "[", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"-", 
              RowBox[{"Outer", "[", 
               RowBox[{"Times", ",", "eigs", ",", "tGrid"}], "]"}]}], "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"X", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"t", "^", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "3"}], "/", "2"}], ",", 
               RowBox[{"-", "1"}], ",", 
               RowBox[{
                RowBox[{"-", "1"}], "/", "2"}], ",", "0"}], "}"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "tGrid"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coef", "=", 
          RowBox[{
           RowBox[{"PseudoInverse", "[", "X", "]"}], ".", "Z"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"coef", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", " ", "Pi"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"6", " ", 
              RowBox[{"Pi", "^", "2"}]}], ")"}]}], ",", 
           RowBox[{"coef", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"coef", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"4", " ", "Pi"}], ")"}], "^", 
               RowBox[{"(", 
                RowBox[{"3", "/", "2"}], ")"}]}]}], ")"}], "/", 
            RowBox[{"(", 
             RowBox[{"4", " ", 
              RowBox[{"Pi", "^", "3"}]}], ")"}]}]}], "}"}]}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"f", ",", "factors"}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"4.", " ", "Fehler", " ", 
    RowBox[{"(", "%", ")"}], " ", "berechnen"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"errA0", "=", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"scanResults", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}], "/", "A0true"}], "-", "1"}],
      "]"}], "*", "100"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"errA1", "=", 
   RowBox[{
    RowBox[{"Abs", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"scanResults", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}], "/", "A1true"}], "-", "1"}],
      "]"}], "*", "100"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"errA2", "=", 
    RowBox[{
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"scanResults", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "3"}], "]"}], "]"}], "/", "A2Weyl"}], "-", 
       "1"}], "]"}], "*", "100"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"5.", " ", "Plateau"}], "-", 
    RowBox[{"Mittelung", " ", 
     RowBox[{"(", 
      RowBox[{"f", "=", 
       RowBox[{"80", " ", "bis", " ", "150"}]}], ")"}]}]}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"pIdx", "=", 
   RowBox[{"Flatten", "@", 
    RowBox[{"Position", "[", 
     RowBox[{"factors", ",", 
      RowBox[{"f_", "/;", 
       RowBox[{"80", "<=", "f", "<=", "150"}]}]}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"means", "=", 
    RowBox[{"Mean", "[", 
     RowBox[{"scanResults", "[", 
      RowBox[{"[", "pIdx", "]"}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "6.", " ", "Visualisierung", " ", "mit", " ", "fixiertem", " ", "Bereich", 
    " ", "f\[UDoubleDot]r", " ", "alle", " ", "Kurven"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"factors", ",", "errA0"}], "}"}], "]"}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"factors", ",", "errA1"}], "}"}], "]"}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"factors", ",", "errA2"}], "}"}], "]"}]}], "}"}], ",", 
    RowBox[{"Joined", "->", "True"}], ",", 
    RowBox[{"PlotRange", "->", 
     RowBox[{"{", 
      RowBox[{"All", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"10", "^", 
          RowBox[{"-", "7"}]}], ",", "10"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"Erweitert", " ", "nach", " ", "unten"}], ",", 
      RowBox[{"damit", " ", 
       RowBox[{"Blau", "/", "Orange"}], " ", "sichtbar", " ", "werden"}]}], 
     "*)"}], 
    RowBox[{"PlotStyle", "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Directive", "[", 
        RowBox[{"Blue", ",", "Thick"}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{"Orange", ",", "Thick"}], "]"}], ",", 
       RowBox[{"Directive", "[", 
        RowBox[{
         RowBox[{"Darker", "[", "Green", "]"}], ",", "Thick"}], "]"}]}], 
      "}"}]}], ",", 
    RowBox[{"PlotLegends", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<Fehler A0 (Volumen)\>\"", 
       ",", "\"\<Fehler A1 (Fl\[ADoubleDot]che)\>\"", 
       ",", "\"\<Fehler A2 (Kr\[UDoubleDot]mmung)\>\""}], "}"}]}], ",", 
    RowBox[{"Frame", "->", "True"}], ",", 
    RowBox[{"FrameLabel", "->", 
     RowBox[{"{", 
      RowBox[{"\"\<tMin Faktor (f/\[Lambda]N)\>\"", 
       ",", "\"\<Relativer Fehler (%)\>\""}], "}"}]}], ",", 
    RowBox[{
    "PlotLabel", 
     "->", "\"\<Gesamt-Stabilit\[ADoubleDot]tsanalyse der \
Weyl-Koeffizienten\>\""}], ",", 
    RowBox[{"GridLines", "->", "Automatic"}], ",", 
    RowBox[{"ImageSize", "->", "Large"}]}], "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"7.", " ", "Output"}], "-", "Tabelle"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<Koeffizient\>\"", ",", "\"\<Plateau-Mittel\>\"", 
         ",", "\"\<Theorie\>\"", ",", "\"\<Fehler %\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<A0 (Volumen)\>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"means", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", "8"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"A0true", ",", "8"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"100", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"means", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "/", "A0true"}], "-", "1"}], 
             ")"}]}], ",", "5"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<A1 (Fl\[ADoubleDot]che)\>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"means", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "8"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"A1true", ",", "8"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"100", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"means", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "/", "A1true"}], "-", "1"}], 
             ")"}]}], ",", "5"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\"\<A2 (Kr\[UDoubleDot]mmung)\>\"", ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"means", "[", 
            RowBox[{"[", "3", "]"}], "]"}], ",", "8"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{"A2Weyl", ",", "8"}], "]"}], ",", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"100", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"means", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "/", "A2Weyl"}], "-", "1"}], 
             ")"}]}], ",", "5"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"Frame", "->", "All"}], ",", 
     RowBox[{"Alignment", "->", "Left"}], ",", 
     RowBox[{"Background", "->", 
      RowBox[{"{", 
       RowBox[{"None", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Lighter", "[", 
           RowBox[{"Gray", ",", "0.9"}], "]"}], ",", "None"}], "}"}]}], 
       "}"}]}]}], "]"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.9756462425591393`*^9, 3.9756462425591393`*^9}, {
   3.9756464680022144`*^9, 3.975646468662403*^9}, {3.9756465032839565`*^9, 
   3.975646511941618*^9}, {3.975646641648348*^9, 3.975646697515415*^9}, {
   3.975646897637129*^9, 3.975646926553507*^9}, 
   3.9758910691618176`*^9},ExpressionUUID->"aac3a18e-c5e3-bd41-8001-\
0a3423c668bd"],

Cell[BoxData[
 TemplateBox[{
  "Import", "nffil", 
   "\"File \\!\\(\\*RowBox[{\\\"\\\\\\\"C:/Users/sulta/git/cone-operator-lab/\
data/eigenvalues/box_eigs_exact_20000.txt\\\\\\\"\\\"}]\\) not found during \
\\!\\(\\*RowBox[{\\\"Import\\\"}]\\).\"", 2, 3, 1, 24424648608150900133, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.975891058984358*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"1b88f8df-7a67-9546-8d32-e3e1c3e2ba58"],

Cell[BoxData[
 TemplateBox[{
  "Flatten", "normal", 
   "\"Nonatomic expression expected at position \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", \\\"$Failed\\\", \\\"]\\\"}]\\).\"", 2, 3, 2, 24424648608150900133,
    "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9758910590995827`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"78cccc56-e31b-de40-b6a2-725f51ef79bd"],

Cell[BoxData[
 TemplateBox[{
  "Flatten", "argb", 
   "\"\\!\\(\\*RowBox[{\\\"Flatten\\\"}]\\) called with \
\\!\\(\\*RowBox[{\\\"0\\\"}]\\) arguments; between \
\\!\\(\\*RowBox[{\\\"1\\\"}]\\) and \\!\\(\\*RowBox[{\\\"3\\\"}]\\) arguments \
are expected.\"", 2, 3, 3, 24424648608150900133, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.975891059108568*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"99aff5c5-9a61-a040-b138-c1fa0f0f386b"],

Cell[BoxData[
 TemplateBox[{
  "Part", "take", 
   "\"Cannot take positions \\!\\(\\*RowBox[{\\\"1\\\"}]\\) through \
\\!\\(\\*RowBox[{\\\"20000\\\"}]\\) in \\!\\(\\*RowBox[{\\\"Flatten\\\", \
\\\"[\\\", \\\"]\\\"}]\\).\"", 2, 5, 4, 24424648608150900133, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9758910592221127`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"c1b90e82-d76e-3842-8523-25b943828371"],

Cell[BoxData[
 TemplateBox[{
  "Outer", "heads", 
   "\"Heads \\!\\(\\*RowBox[{\\\"List\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"Part\\\"}]\\) at positions \
\\!\\(\\*RowBox[{\\\"3\\\"}]\\) and \\!\\(\\*RowBox[{\\\"2\\\"}]\\) are \
expected to be the same.\"", 2, 15, 5, 24424648608150900133, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.9758910593144283`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"3033339f-56b5-4e40-b81e-32a8962d5247"]
}, Open  ]]
},
WindowSize->{888.75, 590.25},
WindowMargins->{{Automatic, -1265.25}, {-197.25, Automatic}},
FrontEndVersion->"14.3 for Microsoft Windows (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5e654ede-d850-1c4c-8c67-e5464e78a40e"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 13087, 382, 1466, "Input",ExpressionUUID->"aac3a18e-c5e3-bd41-8001-0a3423c668bd"],
Cell[13666, 406, 494, 12, 26, "Message",ExpressionUUID->"1b88f8df-7a67-9546-8d32-e3e1c3e2ba58"],
Cell[14163, 420, 468, 12, 26, "Message",ExpressionUUID->"78cccc56-e31b-de40-b6a2-725f51ef79bd"],
Cell[14634, 434, 500, 12, 26, "Message",ExpressionUUID->"99aff5c5-9a61-a040-b138-c1fa0f0f386b"],
Cell[15137, 448, 466, 11, 26, "Message",ExpressionUUID->"c1b90e82-d76e-3842-8523-25b943828371"],
Cell[15606, 461, 499, 12, 26, "Message",ExpressionUUID->"3033339f-56b5-4e40-b81e-32a8962d5247"]
}, Open  ]]
}
]
*)

