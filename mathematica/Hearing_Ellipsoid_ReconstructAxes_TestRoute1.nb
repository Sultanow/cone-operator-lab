(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     11663,        349]
NotebookOptionsPosition[     11174,        332]
NotebookOutlinePosition[     11576,        348]
CellTagsIndexPosition[     11533,        345]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"A0", "=", "0.244038"}], ";", 
  RowBox[{"A1", "=", 
   RowBox[{"-", "0.623796"}]}], ";", 
  RowBox[{"A2", "=", "0.175364"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Vspec", "=", 
   RowBox[{"6", " ", 
    RowBox[{"Pi", "^", "2"}], " ", "A0"}]}], ";", 
  RowBox[{"Sspec", "=", 
   RowBox[{
    RowBox[{"-", "16"}], " ", "Pi", " ", "A1"}]}], ";", 
  RowBox[{"Mspec", "=", 
   RowBox[{"12", " ", 
    RowBox[{"Pi", "^", "2"}], " ", "A2"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Pspec", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"3", " ", "Vspec"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"4", " ", "Pi"}], ")"}]}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rSym", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", " ", 
      RowBox[{"Sin", "[", "th", "]"}], " ", 
      RowBox[{"Cos", "[", "ph", "]"}]}], ",", 
     RowBox[{"b", " ", 
      RowBox[{"Sin", "[", "th", "]"}], " ", 
      RowBox[{"Sin", "[", "ph", "]"}]}], ",", 
     RowBox[{"c", " ", 
      RowBox[{"Cos", "[", "th", "]"}]}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ru", "=", 
   RowBox[{"D", "[", 
    RowBox[{"rSym", ",", "th"}], "]"}]}], ";", 
  RowBox[{"rv", "=", 
   RowBox[{"D", "[", 
    RowBox[{"rSym", ",", "ph"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ruu", "=", 
    RowBox[{"D", "[", 
     RowBox[{"rSym", ",", 
      RowBox[{"{", 
       RowBox[{"th", ",", "2"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"ruv", "=", 
    RowBox[{"D", "[", 
     RowBox[{"rSym", ",", "th", ",", "ph"}], "]"}]}], ";", 
   RowBox[{"rvv", "=", 
    RowBox[{"D", "[", 
     RowBox[{"rSym", ",", 
      RowBox[{"{", 
       RowBox[{"ph", ",", "2"}], "}"}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"E1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ru", ".", "ru"}], "]"}]}], ";", 
  RowBox[{"F1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"ru", ".", "rv"}], "]"}]}], ";", 
  RowBox[{"G1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"rv", ".", "rv"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"nVec", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Cross", "[", 
     RowBox[{"ru", ",", "rv"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"dSSym", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Norm", "[", "nVec", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"nHat", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{"nVec", "/", "dSSym"}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"e2", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"nHat", ".", "ruu"}], "]"}]}], ";", 
  RowBox[{"f2", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"nHat", ".", "ruv"}], "]"}]}], ";", 
  RowBox[{"g2", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"nHat", ".", "rvv"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"HbarSym", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"e2", " ", "G1"}], "-", 
        RowBox[{"2", " ", "f2", " ", "F1"}], "+", 
        RowBox[{"g2", " ", "E1"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"E1", " ", "G1"}], "-", 
          RowBox[{"F1", "^", "2"}]}], ")"}]}], ")"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"numeric", " ", "geometry"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eps", "=", 
   RowBox[{"10", "^", 
    RowBox[{"-", "6"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Sgeo", "[", 
     RowBox[{
      RowBox[{"aa_", "?", "NumericQ"}], ",", 
      RowBox[{"bb_", "?", "NumericQ"}], ",", 
      RowBox[{"cc_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{"dSSym", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", "aa"}], ",", 
         RowBox[{"b", "->", "bb"}], ",", 
         RowBox[{"c", "->", "cc"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"th", ",", "eps", ",", 
        RowBox[{"Pi", "-", "eps"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ph", ",", "0", ",", 
        RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
      RowBox[{"Method", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<LocalAdaptive\>\"", ",", 
         RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], "}"}]}], ",", 
      RowBox[{"MaxRecursion", "->", "10"}], ",", 
      RowBox[{"AccuracyGoal", "->", "6"}], ",", 
      RowBox[{"PrecisionGoal", "->", "6"}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Mgeo", "[", 
     RowBox[{
      RowBox[{"aa_", "?", "NumericQ"}], ",", 
      RowBox[{"bb_", "?", "NumericQ"}], ",", 
      RowBox[{"cc_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"HbarSym", " ", "dSSym"}], ")"}], "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"a", "->", "aa"}], ",", 
         RowBox[{"b", "->", "bb"}], ",", 
         RowBox[{"c", "->", "cc"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"th", ",", "eps", ",", 
        RowBox[{"Pi", "-", "eps"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ph", ",", "0", ",", 
        RowBox[{"2", " ", "Pi"}]}], "}"}], ",", 
      RowBox[{"Method", "->", 
       RowBox[{"{", 
        RowBox[{"\"\<LocalAdaptive\>\"", ",", 
         RowBox[{"\"\<SymbolicProcessing\>\"", "->", "0"}]}], "}"}]}], ",", 
      RowBox[{"MaxRecursion", "->", "10"}], ",", 
      RowBox[{"AccuracyGoal", "->", "6"}], ",", 
      RowBox[{"PrecisionGoal", "->", "6"}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cFrom", "[", 
    RowBox[{
     RowBox[{"aa_", "?", "NumericQ"}], ",", 
     RowBox[{"bb_", "?", "NumericQ"}]}], "]"}], ":=", 
   RowBox[{"Pspec", "/", 
    RowBox[{"(", 
     RowBox[{"aa", " ", "bb"}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"obj2D", "[", 
     RowBox[{
      RowBox[{"aa_", "?", "NumericQ"}], ",", 
      RowBox[{"bb_", "?", "NumericQ"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"cc", ",", "Sval", ",", "Mval"}], "}"}], ",", 
      RowBox[{
       RowBox[{"cc", "=", 
        RowBox[{"cFrom", "[", 
         RowBox[{"aa", ",", "bb"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"cc", "<=", "0"}], ",", 
         RowBox[{"10", "^", "12"}], ",", 
         RowBox[{
          RowBox[{"Sval", "=", 
           RowBox[{"Sgeo", "[", 
            RowBox[{"aa", ",", "bb", ",", "cc"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Mval", "=", 
           RowBox[{"Abs", "[", 
            RowBox[{"Mgeo", "[", 
             RowBox[{"aa", ",", "bb", ",", "cc"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Sval", "-", "Sspec"}], ")"}], "/", "Sspec"}], ")"}], "^",
             "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Mval", "-", "Mspec"}], ")"}], "/", "Mspec"}], ")"}], "^",
             "2"}]}]}]}], "]"}]}]}], "]"}]}], ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r0", "=", 
   RowBox[{"N", "[", 
    RowBox[{"Pspec", "^", 
     RowBox[{"(", 
      RowBox[{"1", "/", "3"}], ")"}]}], "]"}]}], ";", 
  RowBox[{"bounds", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.1", " ", "r0"}], ",", 
     RowBox[{"10", " ", "r0"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"sol", "=", 
    RowBox[{"NMinimize", "[", 
     RowBox[{
      RowBox[{"obj2D", "[", 
       RowBox[{"aa", ",", "bb"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"aa", ",", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"bb", ",", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"bounds", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"Method", "->", "\"\<NelderMead\>\""}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"axes", "=", 
   RowBox[{
    RowBox[{"N", "@", 
     RowBox[{"{", 
      RowBox[{"aa", ",", "bb", ",", 
       RowBox[{"cFrom", "[", 
        RowBox[{"aa", ",", "bb"}], "]"}]}], "}"}]}], "/.", " ", 
    RowBox[{"sol", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Reconstructed axes: \>\"", ",", "axes"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.975323524921215*^9, 3.975323524921215*^9}, {
   3.9753236813245773`*^9, 3.975323682606367*^9}, {3.975323766899151*^9, 
   3.9753237735638123`*^9}, {3.975323863125704*^9, 3.9753238643940735`*^9}, 
   3.975323942300995*^9, {3.9753239877451954`*^9, 3.975323992279173*^9}, {
   3.9753241216398697`*^9, 3.975324122857317*^9}, {3.9753243142654533`*^9, 
   3.9753243155767097`*^9}, {3.975324396373667*^9, 3.9753243973758774`*^9}, 
   3.975324599610754*^9, {3.975324726895647*^9, 3.975324752380583*^9}, {
   3.9753249280306473`*^9, 3.9753249462017746`*^9}, {3.9753249854469795`*^9, 
   3.97532514369569*^9}, {3.9753252313425865`*^9, 3.97532523445142*^9}, {
   3.9753254622017*^9, 3.975325473497444*^9}, {3.9753257663612633`*^9, 
   3.975325768361145*^9}, {3.9753276506437244`*^9, 3.9753276511701317`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"0eb83aa6-1d52-204b-8445-0ecc5a59b251"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Reconstructed axes: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "2.299987256503317`", ",", "0.9999990280103429`", ",", 
     "1.5000123542439885`"}], "}"}]}],
  SequenceForm[
  "Reconstructed axes: ", {2.299987256503317, 0.9999990280103429, 
   1.5000123542439885`}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.975324605113985*^9, {3.9753247309085484`*^9, 3.9753247567507896`*^9}, 
   3.975325246045004*^9, 3.9753256700174713`*^9, 3.9753258386482544`*^9, 
   3.9753277143393955`*^9},
 CellLabel->
  "During evaluation of \
In[24]:=",ExpressionUUID->"27d5c511-ce71-6245-a395-a4a5e0fcc512"]
}, Open  ]]
},
WindowSize->{1908, 999.75},
WindowMargins->{{1026, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.3 for Microsoft Windows (64-bit) (July 8, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"4e08e1fb-c7b7-b74a-b20c-ed3b54b7ec51"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 9912, 288, 1031, "Input",ExpressionUUID->"0eb83aa6-1d52-204b-8445-0ecc5a59b251"],
Cell[10491, 312, 667, 17, 22, "Print",ExpressionUUID->"27d5c511-ce71-6245-a395-a4a5e0fcc512"]
}, Open  ]]
}
]
*)

