(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     11018,        262]
NotebookOptionsPosition[     10399,        242]
NotebookOutlinePosition[     10803,        258]
CellTagsIndexPosition[     10760,        255]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"1.", " ", "Geometrie", " ", "definieren"}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"a", "=", "1.0"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"b", "=", "1.5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"c", "=", "2.3"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"ellipsoidRegion", "=", 
    RowBox[{"Ellipsoid", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], "]"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Mesh", " ", "erzeugen", " ", "und", " ", "feinere", " ", 
    "Diskretisierung", " ", "f\[UDoubleDot]r", " ", "bessere", " ", 
    "Eigenwerte"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mesh", "=", 
    RowBox[{"ToElementMesh", "[", "\[IndentingNewLine]", 
     RowBox[{"ellipsoidRegion", ",", "\[IndentingNewLine]", 
      RowBox[{"MaxCellMeasure", "->", 
       RowBox[{"1.", "*", 
        RowBox[{"10", "^", 
         RowBox[{"-", "4"}]}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<MeshOrder\>\"", "->", "2"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Print", "[", 
    RowBox[{"\"\<Elementanzahl im Mesh: \>\"", ",", 
     RowBox[{"mesh", "[", "\"\<MeshOrder\>\"", "]"}], ",", 
     "\"\<, Zellen: \>\"", ",", 
     RowBox[{"mesh", "[", "\"\<MeshElementCount\>\"", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"numEigs", "=", "1800"}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"\[Lambda]list", "=", 
   RowBox[{"NDEigenvalues", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Laplacian", "[", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"DirichletCondition", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], "==", "0"}], ",", 
         "True"}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"u", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}], "\[Element]", "mesh"}], ",", 
     "\[IndentingNewLine]", "numEigs", ",", "\[IndentingNewLine]", 
     RowBox[{"Method", "->", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"\"\<Eigensystem\>\"", "->", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"\"\<Arnoldi\>\"", ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<MaxIterations\>\"", "->", "80000"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<Tolerance\>\"", "->", 
           RowBox[{"10", "^", 
            RowBox[{"-", "8"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
       "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]sorted", "=", 
    RowBox[{"Sort", "@", "\[Lambda]list"}]}], ";"}], "\n", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "2.", " ", "Ausgabe", " ", "der", " ", "Eigenwerte", " ", "erzwingen"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Print", "[", "\"\<--- Erste 20 Dirichlet-Eigenwerte (3D Volumen) ---\>\"", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{
    RowBox[{"Take", "[", 
     RowBox[{"\[Lambda]sorted", ",", "20"}], "]"}], "//", "Column"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
   "\"\<C:\\\\Users\\\\sulta\\\\git\\\\cone-operator-lab\\\\mathematica\\\\\
ellipsoid_eigs_a1_b1.5_c2.3.txt\>\"", ",", "\[Lambda]sorted", ",", 
    "\"\<Table\>\""}], "]"}], ";"}], "\n"}], "Input",
 CellChangeTimes->{{3.972748261297674*^9, 3.972748321548092*^9}, {
   3.972753412649185*^9, 3.972753418239153*^9}, {3.9727540475343704`*^9, 
   3.9727540595326233`*^9}, {3.9727540975873833`*^9, 
   3.9727541489092712`*^9}, {3.9727548413133144`*^9, 
   3.9727548435501156`*^9}, {3.972754922797655*^9, 3.972754943688671*^9}, {
   3.9727549832418175`*^9, 3.972754984566908*^9}, {3.9727550433322334`*^9, 
   3.9727550657828083`*^9}, {3.972755251266676*^9, 3.9727552525630856`*^9}, {
   3.9727553116789627`*^9, 3.9727553143902245`*^9}, {3.9727553693625126`*^9, 
   3.972755375530012*^9}, 3.9727558231899414`*^9, {3.972755951208767*^9, 
   3.9727559525166607`*^9}, {3.972755989549158*^9, 3.9727560658174744`*^9}, {
   3.972756161115366*^9, 3.972756175472809*^9}, {3.972756219596493*^9, 
   3.9727562557789555`*^9}, {3.9727564022387066`*^9, 3.972756419460842*^9}, {
   3.9727564598754177`*^9, 3.972756472719511*^9}, {3.972756556721033*^9, 
   3.972756575779148*^9}, {3.9727566108156033`*^9, 3.972756627360737*^9}, {
   3.973219895013525*^9, 3.973219922106186*^9}, {3.9732200488176727`*^9, 
   3.973220050383665*^9}, {3.973226306729515*^9, 3.973226310093628*^9}, 
   3.9732263726002483`*^9, {3.9732264510767975`*^9, 3.9732265007733135`*^9}, {
   3.973226623236315*^9, 3.9732266248119984`*^9}, {3.9732273518467426`*^9, 
   3.9732273804569225`*^9}, {3.973229139859892*^9, 3.9732291412107925`*^9}, {
   3.9732291997823143`*^9, 3.9732292084447746`*^9}, {3.9732327330456905`*^9, 
   3.9732328014215794`*^9}, {3.9734857081121674`*^9, 
   3.9734857087680607`*^9}, {3.9734861534582424`*^9, 3.973486406358719*^9}, {
   3.97348658423575*^9, 3.973486642306307*^9}, {3.9734869043949223`*^9, 
   3.973486921899559*^9}, {3.9734871218824787`*^9, 3.9734871783850937`*^9}, 
   3.973487254521549*^9, {3.973487360242285*^9, 3.9734873666941586`*^9}, 
   3.9734874714695835`*^9, {3.973487557719368*^9, 3.9734875751916256`*^9}, {
   3.973487723792782*^9, 3.9734877361049786`*^9}, 3.973487900344652*^9, {
   3.973488020555172*^9, 3.9734880722794285`*^9}, {3.9734881046473026`*^9, 
   3.9734881083652554`*^9}, {3.9734888893339424`*^9, 
   3.9734888987294807`*^9}, {3.9734896318714085`*^9, 
   3.9734897106032314`*^9}, {3.973489939106514*^9, 3.9734899505943127`*^9}, {
   3.973489983977724*^9, 3.9734900016311455`*^9}, 3.973490092820986*^9, 
   3.97349056198312*^9, {3.973490641900713*^9, 3.973490675860195*^9}, {
   3.973490943092306*^9, 3.973490967732046*^9}, {3.9734911580832863`*^9, 
   3.973491214292803*^9}, {3.9734914179770737`*^9, 3.9734914331061287`*^9}, {
   3.9734917491324997`*^9, 3.9734917509227543`*^9}, {3.9734918324855385`*^9, 
   3.973491833644598*^9}, 3.973492210362196*^9, {3.9734922537064667`*^9, 
   3.973492254638586*^9}, 3.973492580869856*^9, {3.973492618048807*^9, 
   3.9734926530339336`*^9}, {3.9734926901896725`*^9, 
   3.9734927041509666`*^9}, {3.973492745502304*^9, 3.9734927676275826`*^9}, {
   3.973492888555767*^9, 3.97349288866971*^9}, {3.9734929344973717`*^9, 
   3.973492935351839*^9}, 3.973492991098015*^9, {3.973500919445383*^9, 
   3.9735010607282486`*^9}, {3.97350172234824*^9, 3.9735017361641273`*^9}, {
   3.973504145012804*^9, 3.973504171621256*^9}, {3.973504335080019*^9, 
   3.973504362898155*^9}, {3.9735045747246857`*^9, 3.9735046059046135`*^9}, {
   3.9735144321944275`*^9, 3.973514433971195*^9}, {3.97351450692725*^9, 
   3.97351455173736*^9}, {3.9735145840886745`*^9, 3.9735146233351*^9}, {
   3.973566800679102*^9, 3.9735668964538536`*^9}, {3.973566934669855*^9, 
   3.9735669373040295`*^9}, {3.9735669932912216`*^9, 
   3.973567115837658*^9}},ExpressionUUID->"e17b0a34-6cc5-7e4e-80ca-\
b7eb9f83e8a1"],

Cell[CellGroupData[{

Cell[BoxData["\<\"--- Erste 20 Dirichlet-Eigenwerte (3D Volumen) ---\"\>"], \
"Print",
 CellChangeTimes->{3.973489720321821*^9, 3.973490016380907*^9, 
  3.9734902860539*^9, 3.9734907423197517`*^9, 3.9734909907684975`*^9, 
  3.9734912330703316`*^9, 3.9734914445311546`*^9, 3.9734918505705643`*^9, 
  3.973492706736046*^9, 3.9734928201903286`*^9, 3.9734929525810986`*^9, 
  3.9734936589657*^9, 3.9735015977785435`*^9, 3.973503809556793*^9, 
  3.9735077304427395`*^9, 3.973528325297474*^9},
 CellLabel->
  "During evaluation of \
In[1111]:=",ExpressionUUID->"4fb74f25-83b9-304d-8aad-9ab2ec311aef"],

Cell[BoxData[
 TagBox[GridBox[{
    {"5.304786325301038`"},
    {"7.907090829824384`"},
    {"10.076250905626317`"},
    {"11.231056420690145`"},
    {"13.447585859728242`"},
    {"14.407515851899035`"},
    {"15.313236710180288`"},
    {"16.81120211517686`"},
    {"17.4919085300199`"},
    {"18.29001605802933`"},
    {"20.169932250423166`"},
    {"21.053279214278824`"},
    {"21.072416807019046`"},
    {"22.224263546413013`"},
    {"22.817340299730965`"},
    {"25.50416515253012`"},
    {"25.65799915083353`"},
    {"25.801255572575112`"},
    {"25.97019773910376`"},
    {"27.664337003255753`"}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Print",
 CellChangeTimes->{3.973489720321821*^9, 3.973490016380907*^9, 
  3.9734902860539*^9, 3.9734907423197517`*^9, 3.9734909907684975`*^9, 
  3.9734912330703316`*^9, 3.9734914445311546`*^9, 3.9734918505705643`*^9, 
  3.973492706736046*^9, 3.9734928201903286`*^9, 3.9734929525810986`*^9, 
  3.9734936589657*^9, 3.9735015977785435`*^9, 3.973503809556793*^9, 
  3.9735077304427395`*^9, 3.973528325330759*^9},
 CellLabel->
  "During evaluation of \
In[1111]:=",ExpressionUUID->"fceec6e9-1f31-ef41-893a-9e4a8eb56ee3"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1016.25, 611.625},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"14.1 for Microsoft Windows (64-bit) (July 16, 2024)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"64f6c136-0a57-4843-8d61-bad993e8d2d1"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 7882, 165, 1020, "Input",ExpressionUUID->"e17b0a34-6cc5-7e4e-80ca-b7eb9f83e8a1"],
Cell[CellGroupData[{
Cell[8483, 191, 594, 10, 22, "Print",ExpressionUUID->"4fb74f25-83b9-304d-8aad-9ab2ec311aef"],
Cell[9080, 203, 1291, 35, 313, "Print",ExpressionUUID->"fceec6e9-1f31-ef41-893a-9e4a8eb56ee3"]
}, Open  ]]
}, Open  ]]
}
]
*)

